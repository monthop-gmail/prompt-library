# POC Prompt: ระบบ Odoo บริหารสาขาสถาบันพลังจิตตานุภาพ (Multi-Tenant)

> **เอกสารนี้ใช้เป็น Prompt สำหรับทีมพัฒนา** ในการทำ Proof of Concept ระบบ Odoo  
> เพื่อบริหารจัดการสาขาของสถาบันพลังจิตตานุภาพ แบบ Multi-Tenant  
> อ้างอิงข้อมูลจาก samathi101.com และ business rules จากผู้ดูแลระบบ

---

## 1. บริบทองค์กร

### 1.1 เกี่ยวกับสถาบัน

สถาบันพลังจิตตานุภาพ ก่อตั้งเมื่อ 24 กรกฎาคม 2540 ณ นครธรรม พระมหาเจดีย์ วัดธรรมมงคลเถาบุญญนนท์วิหาร สุขุมวิท 101 กรุงเทพมหานคร โดยสมเด็จพระญาณวชิโรดม (หลวงพ่อวิริยังค์ สิรินฺธโร) มีจุดประสงค์เผยแผ่สมาธิสายหลวงปู่มั่น ภูริทัตโต แก่ประชาชนทุกเพศ ทุกวัย ทุกอาชีพ

### 1.2 ขนาดองค์กร

- **สาขา:** มากกว่า 300 สาขาทั่วประเทศไทย + สาขาต่างประเทศ (แคนาดา, สหรัฐอเมริกา)
- **สำนักงานใหญ่:** วัดธรรมมงคล กรุงเทพฯ
- **ประธานกรรมการ:** นายมีชัย ฤชุพันธุ์
- **มูลนิธิ:** มูลนิธิสถาบันพลังจิตตานุภาพ หลวงพ่อวิริยังค์ สิรินฺธโร
- **เว็บไซต์หลัก:** samathi101.com

### 1.3 ลักษณะสาขา

สาขาส่วนใหญ่ตั้งอยู่ในวัด, มหาวิทยาลัย หรือสถานที่ของผู้อุปถัมภ์ เช่น:
- สาขา 5 วัดดอนรัก จ.สงขลา
- สาขา 40 วัดตรีรัตนาราม จ.ระยอง
- สาขา 117 วัดโสภาราม จ.ปทุมธานี
- สาขา 173 วัดหนามแดง
- สาขา 193 วัดคุณหญิงส้มจีน จ.ปทุมธานี
- สาขา 226 วัดพุทธปัญญา จ.นนทบุรี
- สาขา 296 วัดศรีเกิด จ.เชียงใหม่
- สาขา 306 วัดไผ่เหลือง บางบัวทอง

**สาขาจะมีหมายเลขประจำ** (เช่น สาขา 5, สาขา 40, สาขา 117) เป็นรหัสหลักในการอ้างอิง

---

## 2. Multi-Tenant Architecture

### 2.1 แนวทางที่เลือก: Multi-Company บน Odoo Instance เดียว

| รายการ | รายละเอียด |
|--------|-----------|
| **Odoo Instance** | 1 Instance |
| **Company (บริษัท)** | 1 Parent Company (สำนักงานใหญ่ / มูลนิธิ) + N Child Companies (แต่ละสาขา) |
| **Database** | 1 Database แชร์ master data |
| **Data Isolation** | ใช้ Record Rules แยกข้อมูลรายสาขา |
| **Consolidation** | HQ มองเห็นข้อมูลรวมทุกสาขา ผ่าน inter-company rules |

### 2.2 การแมป Company

```
มูลนิธิสถาบันพลังจิตตานุภาพ (Parent Company)
├── สาขา 5 วัดดอนรัก (Child Company)
├── สาขา 40 วัดตรีรัตนาราม (Child Company)
├── สาขา 117 วัดโสภาราม (Child Company)
├── สาขา 173 วัดหนามแดง (Child Company)
├── ...
└── สาขา 306 วัดไผ่เหลือง (Child Company)
```

### 2.3 Data Sync จาก samathi101.com

| ข้อมูล | แหล่งที่มา | ทิศทาง | วิธีการ |
|--------|-----------|--------|--------|
| รายชื่อสาขา + ที่อยู่ + เบอร์โทร | samathi101.com/branch | samathi101 → Odoo | API / Web Scraping → Import |
| กิจกรรม / คอร์สที่เปิดสอน | samathi101.com/events | samathi101 → Odoo | API / Web Scraping → Import |
| นักศึกษาลงทะเบียน | samathi101.com (ถ้ามี API) | samathi101 ↔ Odoo | Two-way sync (ถ้าเป็นไปได้) |
| ข่าวสาร | samathi101.com/news | samathi101 → Odoo | Read-only reference |

> **หมายเหตุ POC:** เริ่มจาก one-time import ก่อน แล้วค่อยทำ scheduled sync ใน phase ถัดไป

---

## 3. หลักสูตร (Course Master Data)

หลักสูตรเป็น **master data ที่ส่วนกลางกำหนด** สาขาเลือกเปิดสอนตามที่ได้รับอนุญาต

### 3.1 หลักสูตรหลัก

| รหัส | ชื่อหลักสูตร | ชื่อเต็ม | ระยะเวลา | ค่าใช้จ่าย | หมายเหตุ |
|------|-------------|----------|----------|-----------|---------|
| **KRU** | หลักสูตรครูสมาธิ | หลักสูตรครูสอนสมาธิ (Hi-Tech Meditation) | 6 เดือน (200 ชม.) แบ่ง 3 เทอม เทอมละ 40 วัน | ฟรี | หลักสูตรหลักของสถาบัน มีสอบภาคสนาม ณ ดอยอินทนนท์ 4 วัน 3 คืน |
| **CHIN1** | ชินนสาสมาธิ 1 | สมาธิเพื่อชนะใจตนเอง | 1 วัน (2/3/6 ชม.) | ฟรี | หลักสูตรระยะสั้น เหมาะสำหรับเผยแผ่ |
| **WITUN** | วิทันตสาสมาธิ | การฝึกฝนตนเองที่วิเศษ | ~6 เดือน (ภาคออนไซต์/ออนไลน์) | ฟรี | หลักสูตรต่อเนื่อง |
| **WITHI** | วิทิสาสมาธิ | - | 1 เดือน | ฟรี | หลักสูตรเสริม |
| **YAAN** | ญาณสาสมาธิ | ความหยั่งรู้จากสมาธิ | ~5 สัปดาห์ (ออนไลน์) | ฟรี | สอนจากเทปบันทึกหลวงพ่อ |
| **UTTAMA** | อุตมสาสมาธิ | - | (ออนไลน์) | ฟรี | หลักสูตรขั้นสูง |
| **AJARIYA** | อาจาริยสาสมาธิ | หลักสูตรอบรมอาจาริยสา | 3 วัน (อบรมเข้ม) | - | **ส่วนกลางจัดเท่านั้น** สำหรับผลิตอาจารย์สมาธิ |

### 3.2 โครงสร้างรุ่น (Batch/Cohort)

แต่ละหลักสูตรจะเปิดเป็น **รุ่น (รุ่นที่ N)** โดยมีชื่อรุ่นเป็นภาษาบาลี เช่น:
- รุ่นที่ 30 = ติงสโม วิสุทธิธรรม
- รุ่นที่ 32 = ทวัตติงสโม
- รุ่นที่ 34 = จตุตติงสโม
- รุ่นที่ 39 = เอกูนจัตตาฬิสโม อัตตชัย
- รุ่นที่ 43 = ...
- รุ่นที่ 50, 51, 52 = รุ่นล่าสุด

**แต่ละสาขาเปิดรุ่นอิสระ** แต่หมายเลขรุ่นเป็นตัวเดียวกันทั่วประเทศ (เช่น ทุกสาขาเปิดรุ่น 52 พร้อมกัน)

---

## 4. บุคลากร / สมาชิกสาขา (Staff & Member Model)

### 4.1 ประเภทบุคลากร

```
สมาชิกสาขา (Branch Member / Staff)
├── เจ้าหน้าที่สาขา (Branch Staff)
│   ├── ผู้จัดการสาขา (Branch Manager)
│   ├── เจ้าหน้าที่ทั่วไป (General Staff)
│   └── พี่เลี้ยง (Mentor / Assistant)
│
├── อาจารย์สมาธิ (Meditation Teacher / Ajarn) ⭐
│   ├── จบหลักสูตรอาจาริยสาสมาธิ (AJARIYA) — บังคับ
│   ├── ขึ้นทะเบียนโดยส่วนกลาง — บังคับ
│   ├── มีรุ่นอาจาริยสาที่จบ (เช่น รุ่นที่ 27)
│   └── สังกัดสาขาหลัก 1 แห่ง แต่สอนข้ามสาขาได้
│
└── อาสาสมัคร (Volunteer)
```

### 4.2 Business Rules สำหรับ "อาจารย์สมาธิ" ⭐ (สำคัญมาก)

| กฎ | รายละเอียด |
|----|-----------|
| **คุณสมบัติ** | ต้องจบหลักสูตร **อาจาริยสาสมาธิ (AJARIYA)** เท่านั้น จึงจะได้รับสิทธิ์เป็นอาจารย์ |
| **การขึ้นทะเบียน** | **ส่วนกลาง (HQ) เป็นผู้ขึ้นทะเบียนอาจารย์** สาขาไม่สามารถแต่งตั้งเองได้ |
| **รุ่นที่จบ** | บันทึกรุ่นอาจาริยสาที่จบ เช่น รุ่นที่ 27 |
| **สังกัดสาขา** | อาจารย์มีสาขาหลัก (home branch) 1 แห่ง |
| **สอนข้ามสาขา** | ✅ อาจารย์สามารถ **สอนต่างสาขาได้** (multi-branch teaching) |
| **สอนหลายหลักสูตร** | ✅ อาจารย์ 1 คนสามารถ **สอนได้หลายหลักสูตร** (เช่น สอนทั้ง KRU และ WITUN) |
| **ค่ารถสอนครูสมาธิ** | เมื่ออาจารย์ไป **สอนหลักสูตรครูสมาธิ (KRU)** ที่สาขาอื่น → **ส่วนกลางจ่ายค่ารถ 500 บาท/ครั้ง** |
| **เงื่อนไขค่ารถ** | ค่ารถ 500 บาทจ่ายเฉพาะกรณี: (1) สอนหลักสูตรครูสมาธิ (KRU) เท่านั้น, (2) สอนที่สาขาอื่นที่ไม่ใช่สาขาหลักของอาจารย์ |

### 4.3 Data Model: อาจารย์สมาธิ

```python
class MeditationTeacher(models.Model):
    _name = 'willpower.teacher'
    _description = 'อาจารย์สมาธิ'

    # ข้อมูลพื้นฐาน
    member_id        = fields.Many2one('willpower.member')     # ลิงก์ไปสมาชิก
    name             = fields.Char(related='member_id.name')
    
    # คุณสมบัติอาจาริยสา
    ajariya_batch_id = fields.Many2one('willpower.batch')      # รุ่นอาจาริยสาที่จบ
    ajariya_date     = fields.Date('วันที่จบอาจาริยสา')
    registration_date = fields.Date('วันที่ขึ้นทะเบียน')
    registered_by    = fields.Many2one('res.users')            # ผู้ขึ้นทะเบียน (HQ เท่านั้น)
    state            = fields.Selection([
        ('pending', 'รอขึ้นทะเบียน'),
        ('active', 'ขึ้นทะเบียนแล้ว'),
        ('suspended', 'ระงับชั่วคราว'),
        ('retired', 'เกษียณ')
    ])
    
    # สังกัดและความสามารถ
    home_branch_id   = fields.Many2one('res.company')          # สาขาหลัก
    teachable_course_ids = fields.Many2many('willpower.course') # หลักสูตรที่สอนได้

class TeachingAssignment(models.Model):
    _name = 'willpower.teaching.assignment'
    _description = 'การมอบหมายการสอน'

    teacher_id       = fields.Many2one('willpower.teacher')
    course_batch_id  = fields.Many2one('willpower.course.batch') # คอร์ส+รุ่น ที่สอน
    branch_id        = fields.Many2one('res.company')            # สาขาที่ไปสอน
    is_cross_branch  = fields.Boolean(compute='_compute_cross_branch')
    
    # ค่ารถ
    transport_eligible = fields.Boolean(compute='_compute_transport')
    transport_amount   = fields.Float(default=500.0)
    transport_state    = fields.Selection([
        ('pending', 'รอเบิก'),
        ('approved', 'อนุมัติ'),
        ('paid', 'จ่ายแล้ว')
    ])

    def _compute_cross_branch(self):
        for rec in self:
            rec.is_cross_branch = (rec.branch_id != rec.teacher_id.home_branch_id)

    def _compute_transport(self):
        """ค่ารถ 500 บาท เฉพาะสอนครูสมาธิ (KRU) + สอนข้ามสาขา"""
        for rec in self:
            rec.transport_eligible = (
                rec.is_cross_branch and
                rec.course_batch_id.course_id.code == 'KRU'
            )
```

---

## 5. โมดูลหลัก POC

### 5.1 Module: willpower_branch — บริหารสาขา

| ฟีเจอร์ | รายละเอียด |
|---------|-----------|
| ข้อมูลสาขา | หมายเลขสาขา, ชื่อ, ที่ตั้ง (วัด/สถาบัน), จังหวัด, ภาค, เบอร์โทร |
| ผู้ดูแลสาขา | ผู้จัดการสาขา, เบอร์ติดต่อ |
| สถานะ | Active / Inactive |
| ประเภทการเรียน | วันจันทร์-ศุกร์ / เสาร์-อาทิตย์ / ออนไลน์ |
| ความจุ | จำนวนที่นั่งสูงสุด |
| Sync | เชื่อมข้อมูลจาก samathi101.com/branch |

### 5.2 Module: willpower_course — บริหารหลักสูตรและรุ่น

| ฟีเจอร์ | รายละเอียด |
|---------|-----------|
| หลักสูตร (Master) | รหัส, ชื่อ, ระยะเวลา, จำนวนชม., ประเภท (ส่วนกลาง/สาขาเปิดเอง) |
| รุ่น (Batch) | หมายเลขรุ่น, ชื่อรุ่นภาษาบาลี, วันเปิด-ปิด, สถานะ |
| คอร์สสาขา (Branch Course) | สาขา + หลักสูตร + รุ่น + ตารางเรียน + อาจารย์ผู้สอน |
| เทอม | แบ่งเป็น 3 เทอม (สำหรับหลักสูตรครูสมาธิ) |
| สอบภาคสนาม | ดอยอินทนนท์ 4 วัน 3 คืน (สำหรับ KRU) |
| Sync | เชื่อมข้อมูลจาก samathi101.com/events |

### 5.3 Module: willpower_student — บริหารนักศึกษา

| ฟีเจอร์ | รายละเอียด |
|---------|-----------|
| ลงทะเบียน | ชื่อ, ข้อมูลติดต่อ, สาขาที่สมัคร, หลักสูตร, รุ่น |
| ประวัติ | หลักสูตรที่เรียน, สาขาที่เคยเรียน, รุ่นที่เข้า |
| สถานะ | สมัครแล้ว → กำลังเรียน → สอบผ่าน → จบหลักสูตร / พักการเรียน / ไม่ผ่าน |
| ใบประกาศนียบัตร | ออกใบประกาศเมื่อจบ (จิตตัง ทันตัง สุขาวะหัง) |
| เส้นทาง | นักศึกษา → จบครูสมาธิ → จบอาจาริยสา → ขึ้นทะเบียนเป็นอาจารย์ |
| โอนย้ายสาขา | รองรับการย้ายสาขาระหว่างเรียน |

### 5.4 Module: willpower_teacher — บริหารอาจารย์สมาธิ ⭐

| ฟีเจอร์ | รายละเอียด |
|---------|-----------|
| ทะเบียนอาจารย์ | ข้อมูลส่วนตัว, รุ่นอาจาริยสาที่จบ, วันที่ขึ้นทะเบียน |
| ขึ้นทะเบียน | **ส่วนกลาง (HQ) ดำเนินการเท่านั้น** |
| สาขาหลัก | สังกัดสาขาหลัก 1 แห่ง |
| หลักสูตรที่สอนได้ | many-to-many กับหลักสูตร (สอนได้หลายหลักสูตร) |
| การมอบหมายสอน | บันทึกว่าสอนที่สาขาไหน, คอร์สอะไร, รุ่นอะไร |
| สอนข้ามสาขา | ✅ ระบบตรวจจับอัตโนมัติว่าสาขาที่ไปสอน ≠ สาขาหลัก |
| ค่ารถ 500 บาท | Auto-create เบิกค่ารถเมื่อ (สอน KRU) + (ข้ามสาขา) → ส่วนกลางจ่าย |
| ประวัติการสอน | Log ทุกครั้งที่สอน + สาขา + หลักสูตร |

### 5.5 Module: willpower_finance — การเงินสาขา

| ฟีเจอร์ | รายละเอียด |
|---------|-----------|
| รายรับ | เงินบริจาค, เงินสนับสนุน (การเรียนฟรี แต่มีเงินบริจาคจากศิษย์) |
| รายจ่ายสาขา | ค่าเช่าสถานที่, อุปกรณ์, สาธารณูปโภค, อาหาร/เครื่องดื่ม |
| ค่ารถอาจารย์ | ส่วนกลางจ่าย 500 บาท/ครั้ง (เฉพาะสอนครูสมาธิข้ามสาขา) |
| งบประมาณ | ส่วนกลางจัดสรร vs สาขาหาเอง |
| รายงาน | รายรับ-จ่ายรายสาขา, รายงานรวม HQ |

---

## 6. สิทธิ์การเข้าถึง (Access Control)

### 6.1 Security Groups

| กลุ่ม | ขอบเขตข้อมูล | สิทธิ์หลัก |
|-------|-------------|-----------|
| **Super Admin (HQ)** | ทุกสาขา | CRUD ทุกข้อมูล, ขึ้นทะเบียนอาจารย์, กำหนดหลักสูตร, อนุมัติค่ารถ, ดูรายงานรวม |
| **Branch Manager** | สาขาตนเอง | CRUD ข้อมูลสาขาตนเอง, เปิดคอร์ส, ลงทะเบียนนักศึกษา, ขอมอบหมายอาจารย์ |
| **อาจารย์สมาธิ** | สาขาที่สอน (หลายสาขาได้) | ดูรายชื่อนักศึกษา, ลงผลการเรียน, ดูตารางสอน, เบิกค่ารถ |
| **เจ้าหน้าที่สาขา** | สาขาตนเอง | จัดการนักศึกษา, ดูข้อมูลคอร์ส, บันทึกรายรับ-จ่าย |
| **พี่เลี้ยง** | สาขาตนเอง | ดูรายชื่อนักศึกษา, บันทึกการเข้าเรียน |
| **นักศึกษา (Portal)** | ข้อมูลตนเอง | ดูผลการเรียน, ลงทะเบียนคอร์ส, ดูตารางเรียน |

### 6.2 Record Rules (ตัวอย่าง)

```xml
<!-- สาขามองเห็นเฉพาะนักศึกษาของตน -->
<record id="rule_student_branch" model="ir.rule">
    <field name="name">Student: Branch Only</field>
    <field name="model_id" ref="model_willpower_student"/>
    <field name="groups" eval="[(4, ref('group_branch_staff'))]"/>
    <field name="domain_force">[('branch_id','=',user.company_id.id)]</field>
</record>

<!-- อาจารย์มองเห็นนักศึกษาของสาขาที่ตนสอน (หลายสาขา) -->
<record id="rule_student_teacher" model="ir.rule">
    <field name="name">Student: Teacher Multi-Branch</field>
    <field name="model_id" ref="model_willpower_student"/>
    <field name="groups" eval="[(4, ref('group_teacher'))]"/>
    <field name="domain_force">[('branch_id','in',user.teacher_branch_ids.ids)]</field>
</record>

<!-- HQ มองเห็นทุกอย่าง -->
<record id="rule_student_hq" model="ir.rule">
    <field name="name">Student: HQ Full Access</field>
    <field name="model_id" ref="model_willpower_student"/>
    <field name="groups" eval="[(4, ref('group_hq_admin'))]"/>
    <field name="domain_force">[(1,'=',1)]</field>
</record>
```

---

## 7. Workflow หลัก

### 7.1 Workflow: เปิดคอร์สครูสมาธิใหม่

```
สาขาขอเปิดคอร์สรุ่นใหม่
    │
    ▼
ระบุหลักสูตร + รุ่น + ตารางเรียน + จำนวนที่นั่ง
    │
    ▼
ขออาจารย์ → ส่วนกลางมอบหมายอาจารย์
    │                    │
    │          ┌─────────┴─────────┐
    │          │                   │
    │    อาจารย์สาขาเดียวกัน  อาจารย์ข้ามสาขา
    │          │                   │
    │          │           Auto-create เบิกค่ารถ
    │          │           (ถ้าสอน KRU = 500 บาท/ครั้ง)
    │          └─────────┬─────────┘
    ▼                    ▼
เปิดรับสมัครนักศึกษา
    │
    ▼
ปฐมนิเทศ → เรียน เทอม 1-3 → สอบภาคสนาม (ดอยอินทนนท์)
    │
    ▼
ปัจฉิมนิเทศ → มอบประกาศนียบัตร
```

### 7.2 Workflow: เส้นทางการเป็นอาจารย์

```
บุคคลทั่วไป
    │
    ▼
สมัครเรียนหลักสูตรครูสมาธิ (KRU) ที่สาขาใดก็ได้
    │
    ▼
เรียน 6 เดือน (3 เทอม + สอบภาคสนาม)
    │
    ▼
จบหลักสูตรครูสมาธิ → ได้ใบประกาศนียบัตร
    │
    ▼
สมัครเข้าอบรมหลักสูตรอาจาริยสาสมาธิ (AJARIYA)
    │  ← ส่วนกลางจัดเท่านั้น, อบรม 3 วัน, ~100+ คน/รุ่น
    ▼
จบอาจาริยสา (บันทึกรุ่นที่จบ เช่น รุ่นที่ 27)
    │
    ▼
ส่วนกลาง (HQ) พิจารณาขึ้นทะเบียนเป็นอาจารย์สมาธิ
    │
    ▼
กำหนดหลักสูตรที่สอนได้ + สาขาหลัก
    │
    ▼
พร้อมรับมอบหมายสอน (สาขาใดก็ได้)
```

### 7.3 Workflow: เบิกค่ารถอาจารย์

```
อาจารย์ได้รับมอบหมายสอนที่สาขาอื่น
    │
    ▼
ระบบตรวจสอบ: สาขาที่สอน ≠ สาขาหลัก?
    │
    ├── ไม่ใช่ข้ามสาขา → ไม่มีค่ารถ
    │
    └── ใช่ ข้ามสาขา → ตรวจสอบต่อ: เป็นหลักสูตร KRU?
              │
              ├── ไม่ใช่ KRU → ไม่มีค่ารถ
              │
              └── ใช่ KRU → สร้างรายการเบิกค่ารถ 500 บาท
                        │
                        ▼
                  ส่งอนุมัติ HQ → จ่ายเงิน (ส่วนกลาง)
```

---

## 8. รายงานและ Dashboard

### 8.1 Dashboard HQ (ส่วนกลาง)

| รายงาน | รายละเอียด |
|--------|-----------|
| ภาพรวมสาขา | จำนวนสาขา active, แผนที่สาขา, จำนวนนักศึกษารวม |
| สรุปรุ่นปัจจุบัน | จำนวนสาขาที่เปิดรุ่น, จำนวนนักศึกษา, อัตราจบ |
| ทะเบียนอาจารย์ | จำนวนอาจารย์ทั้งหมด, แยกตามรุ่นอาจาริยสา, สถานะ |
| ค่ารถอาจารย์ | สรุปค่ารถรายเดือน, top 10 อาจารย์ที่สอนข้ามสาขามากสุด |
| การเงินรวม | รายรับ-จ่ายรวมทุกสาขา, เปรียบเทียบรายสาขา |

### 8.2 Dashboard สาขา

| รายงาน | รายละเอียด |
|--------|-----------|
| นักศึกษา | จำนวนนักศึกษาปัจจุบัน, แยกตามหลักสูตร, สถานะ |
| คอร์ส | คอร์สที่กำลังเปิด, ตารางเรียน, อาจารย์ผู้สอน |
| การเข้าเรียน | อัตราเข้าเรียน, นักศึกษาที่ขาดบ่อย |
| การเงินสาขา | รายรับ-จ่ายสาขา, งบคงเหลือ |

---

## 9. ขอบเขต POC

### 9.1 สาขาทดสอบ

| Tenant | สาขา | ลักษณะ | หลักสูตรที่เปิด |
|--------|------|--------|---------------|
| **HQ** | มูลนิธิฯ วัดธรรมมงคล | สำนักงานใหญ่ | ดูแลทุกสาขา + จัดอาจาริยสา |
| **สาขา A** | สาขา 5 วัดดอนรัก จ.สงขลา | ขนาดใหญ่ ภาคใต้ | KRU, CHIN1, WITUN |
| **สาขา B** | สาขา 40 วัดตรีรัตนาราม จ.ระยอง | ขนาดกลาง ภาคตะวันออก | KRU, CHIN1 |
| **สาขา C** | สาขา 193 วัดคุณหญิงส้มจีน จ.ปทุมธานี | ขนาดกลาง ภาคกลาง | KRU, WITHI, WITUN |

### 9.2 ข้อมูลทดสอบ

| รายการ | จำนวน |
|--------|-------|
| อาจารย์สมาธิ | 10 คน (5 คนสอนข้ามสาขา) |
| นักศึกษา | 200 คน (แบ่งตามสาขา) |
| คอร์สที่เปิด | 6 คอร์ส (3 สาขา × 2 หลักสูตร) |
| รุ่น | รุ่นที่ 52 (ปัจจุบัน) |
| รายการค่ารถ | 15 รายการทดสอบ |

### 9.3 เป้าหมาย POC (Success Criteria)

| # | เป้าหมาย | วิธีทดสอบ |
|---|---------|----------|
| 1 | **Data Isolation** — สาขาเห็นเฉพาะข้อมูลตนเอง | Login เป็น staff สาขา A ต้องไม่เห็นนักศึกษาสาขา B |
| 2 | **HQ Consolidation** — ส่วนกลางเห็นข้อมูลรวม | Login เป็น HQ admin ต้องเห็นนักศึกษาทุกสาขา |
| 3 | **Teacher Cross-Branch** — อาจารย์สอนข้ามสาขาได้ | มอบหมายอาจารย์จากสาขา A ไปสอนที่สาขา B สำเร็จ |
| 4 | **Auto Transport Fee** — ค่ารถสร้างอัตโนมัติ | สอน KRU ข้ามสาขา → ระบบสร้างเบิกค่ารถ 500 บาท |
| 5 | **No Transport for Same Branch** — ไม่มีค่ารถสาขาเดียวกัน | สอน KRU ที่สาขาตนเอง → ไม่สร้างค่ารถ |
| 6 | **No Transport for Non-KRU** — ไม่มีค่ารถหลักสูตรอื่น | สอน CHIN1 ข้ามสาขา → ไม่สร้างค่ารถ |
| 7 | **Student Journey** — ลงทะเบียนจนจบ | ลงทะเบียน → เรียน → สอบ → จบ → ออกใบประกาศ |
| 8 | **Teacher Registration** — ขึ้นทะเบียนอาจารย์ | เฉพาะ HQ เท่านั้นที่ขึ้นทะเบียนได้ |
| 9 | **Data Sync** — นำเข้าข้อมูลจาก samathi101.com | Import รายชื่อสาขา + คอร์สที่เปิด สำเร็จ |
| 10 | **Reports** — รายงานถูกต้อง | Dashboard HQ แสดงข้อมูลรวมถูกต้อง |

---

## 10. Tech Stack

| ส่วน | เทคโนโลยี |
|------|----------|
| **ERP** | Odoo 17 Community (หรือ Enterprise ถ้ามีงบ) |
| **Database** | PostgreSQL 15+ |
| **Custom Modules** | willpower_branch, willpower_course, willpower_student, willpower_teacher, willpower_finance |
| **Data Sync** | Python script + Odoo XML-RPC / REST API สำหรับ sync จาก samathi101.com |
| **Deployment (POC)** | Docker Compose (Odoo + PostgreSQL) |
| **Portal** | Odoo Website + Portal สำหรับนักศึกษาดูข้อมูล |

---

## 11. แผน Implementation (POC 6 สัปดาห์)

| สัปดาห์ | งาน | Deliverable |
|---------|-----|-------------|
| **1** | ติดตั้ง Odoo, ตั้งค่า Multi-Company (HQ + 3 สาขา), Import ข้อมูลสาขาจาก samathi101.com | Odoo instance พร้อมใช้, สาขาสร้างครบ |
| **2** | พัฒนา willpower_course: หลักสูตร master data + รุ่น + คอร์สสาขา | CRUD หลักสูตร, เปิดคอร์สรุ่นใหม่ได้ |
| **3** | พัฒนา willpower_student: ลงทะเบียน, ประวัติ, สถานะ + willpower_branch เสริม | ลงทะเบียนนักศึกษาครบ workflow |
| **4** | พัฒนา willpower_teacher: ทะเบียนอาจารย์, มอบหมายสอน, สอนข้ามสาขา, ค่ารถอัตโนมัติ | Teacher module ทำงานครบ business rules |
| **5** | ตั้งค่าสิทธิ์ (Record Rules, Security Groups), willpower_finance เบื้องต้น, Data Sync script | สิทธิ์ถูกต้อง, การเงินพื้นฐาน |
| **6** | Dashboard & Reports, Integration Test, UAT, สรุปผล POC | รายงาน POC + demo |

---

## 12. ความเสี่ยงและข้อจำกัด

| ความเสี่ยง | ผลกระทบ | แนวทางแก้ |
|-----------|---------|----------|
| samathi101.com ไม่มี public API | ไม่สามารถ sync อัตโนมัติได้ | ใช้ web scraping หรือ manual import ก่อน |
| สาขา 300+ แห่ง → Company จำนวนมาก | Performance ของ Odoo multi-company | ทดสอบ load กับ 50+ companies ก่อน scale |
| ข้อมูลเดิมกระจัดกระจาย (Excel, กระดาษ) | Data migration ใช้เวลานาน | เริ่มจากข้อมูลสาขาทดสอบ 3 แห่ง |
| อาจารย์สอนหลายสาขา → ซับซ้อน Record Rules | อาจารย์มองไม่เห็นข้อมูลบางสาขา | ใช้ computed field สำหรับ teacher_branch_ids |
| การเรียนฟรี → ไม่มี invoice flow ชัดเจน | ต้อง customize Accounting module | ใช้ donation/expense flow แทน standard invoicing |

---

> **เอกสารฉบับนี้ใช้เป็นจุดเริ่มต้น POC**  
> หากต้องการรายละเอียดเพิ่มเติม เช่น ERD เต็มรูปแบบ, Odoo module scaffolding,  
> หรือ Docker Compose setup สามารถขอเพิ่มเติมได้
